-- BR / 2023 / DE Students
-- Gets numbers for DE students in district for equity report (Dual enrollment)

DECLARE @equity table 
(--gender varchar(40),
 --raceDescription varchar(40),
 count INT,
 percentag DECIMAL(10,4)
 );

insert into 
@equity

select distinct
--b.gender,
--b.raceDescription,
COUNT(DISTINCT r.studentID) AS 'count',
(COUNT(DISTINCT r.studentID) * 1.0) / (SELECT COUNT(DISTINCT r3.studentID) FROM ala_roster r3
                                            JOIN school s3 ON s3.[school-id] = r3.entityID
                                            JOIN ala_allStudents b3 ON b3.studentID = r3.studentID
                                            WHERE r3.courseName LIKE '%Dual E%') AS 'percentag'

from
  ala_roster r
  join school        s on s.[school-id] = r.entityID
  join ala_allStudents b on b.studentID = r.studentID
where
courseName like '%Dual E%'
--group by
--b.gender,
--b.raceDescription

select *
 from @equity;


--Runs pull to get numbers for DE students
